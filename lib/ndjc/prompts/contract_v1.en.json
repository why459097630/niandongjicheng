[BEGIN PROMPT TEMPLATE]

Produce a valid NDJC Contract v1 JSON object for Android app generation, following these rules:

1. The output must be a single JSON object with the following top-level keys, in this exact order:
   - "metadata"
   - "anchorsGrouped"
   - "files"

2. The "metadata" key must contain the following sub-keys with valid, non-empty values:
   - "packageName" → a valid Android applicationId matching regex ^[a-z][a-z0-9_]*(\.[a-z0-9_]+)+$
   - "appDescription" → a short human-readable description derived from {user_request}
   - "minSdkVersion" → integer between 16–31
   - "targetSdkVersion" → integer between 16–34
   - "compileSdkVersion" → integer between 16–34
   - "gradleVersion" → a valid Gradle version string (e.g. "7.4.1")
   - "permissions" → array of at least one valid Android permission (e.g. "android.permission.INTERNET")

3. The "anchorsGrouped" object must contain **exactly six groups**, in this order:
   - "text"
   - "block"
   - "list"
   - "if"
   - "hook"
   - "gradle"

   Each group is a **dictionary mapping anchor keys (from {registry_json}) to real, buildable values**.
   - Every anchor listed in {registry_json} must appear once and only once.
   - Do not invent new anchors or omit required ones.
   - All anchor values must be non-empty, syntactically valid for Android build, and consistent with registry valueFormat rules.
   - Strings must not contain "<" or ">".
   - Arrays (such as routes, resConfigs, permissions) must contain at least one valid item.
   - For enum or regex constraints in {registry_json}, satisfy them exactly.

4. The "files" object may be either:
   - an empty object `{}` when file generation is handled later by the NDJC pipeline, **or**
   - a minimal valid file set containing AndroidManifest.xml, res/values/strings.xml, and any source files consistent with the anchors.

5. The output must not contain any placeholders (e.g. "__PLACEHOLDER__", "default", "example", "tbd", "N/A"), empty strings, nulls, or empty arrays/objects.

6. The output must conform to Android build syntax and Gradle semantics, producing only one JSON object.

7. Before outputting, the model must perform internal validation:
   - check all keys are present and ordered correctly,
   - ensure every anchor in {registry_json} has a non-empty, valid value,
   - confirm arrays non-empty, regex/enums satisfied, and no illegal characters "<" or ">".

8. The final output must be a **single valid JSON object**, ending with `}` and containing no explanations, markdown, or text after it.

Inputs provided:
- {user_request} → the app description
- {registry_json} → the anchor registry specification

Produce the final NDJC Contract v1 JSON object accordingly.

[END PROMPT TEMPLATE]
